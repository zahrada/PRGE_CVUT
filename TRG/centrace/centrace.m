clear all
clc
format long g

%==========================================================================================================
%|                                              Vstupní data                                              |
%==========================================================================================================

%----------------------------------------------------------------------------------------------------------
%|                                            Souøadnice z GPS                                            |
%----------------------------------------------------------------------------------------------------------

souradnice_gps = [
1004	559774.3308	1053012.1575
1003	560932.5732	1055295.5295
1001	565726.4053	1055371.3622
1005	562455.2553	1055720.5636
1002	560712.2988	1058509.0303
];

%----------------------------------------------------------------------------------------------------------
%|                                         Souøadnice z pøibližné                                         |
%----------------------------------------------------------------------------------------------------------

souradnice_priblizne = [
1001	565722.0	1055381.0
1002	560712.5	1058509.0
1003	560933.5	1055292.5
1004	559774.5	1053012.0
1005	562455.2553	1055720.5636
];

%----------------------------------------------------------------------------------------------------------
%|                                   Úhly v laobratorních jednotkách                                      |
%----------------------------------------------------------------------------------------------------------

uhly = [
%  %skupina3
%  1004	1001	1003	 22.9264	0	0	0	0
%  1003	1001	1002	 36.5777	0	0 	0	0
%  1004	1001	1002	 59.5049	0	0	0	0
%  1001	1002	1003	 60.1596	0	0 	0	0
%  1003	1002	1004	 15.1088	0	0 	0	0
%  1001	1002	1004	 75.2685	0	0 	0	0
%  1004	1003	1002	165.5351	0	0	0	0
%  1002	1003	1005	 87.2420	0	0 	0	0
%  1005	1003	1001	 16.2687	0	0	0	0
%  1001	1003	1004	130.9538	0	0 	0	0
%  1002	1004	1003	 19.2118	0	0 	0	0
%  1003	1004	1001	 45.9742	0	0 	0	0
%  1002	1004	1001	 65.1864	0	0 	0	0



1004	1001	1002	 59.5083	0	0	0	0	0	0	0	0
1004	1001	1003	 22.9335	0	0 	0	0	0	0	0	0
1003	1001	1002	 36.5741	0	0	0	0	0	0	0	0
1001	1002	1004	 75.2803	0	0 	0	0	0	0	0	0
1001	1002	1003	 60.1894	0	0 	0	0	0	0	0	0
1003	1002	1004	 15.0906	0	0 	0	0	0	0	0	0

%bara
%  1001	1003	1004	130.9295	0	0 	0	0
%  1002	1003	1004	234.3050	0	0 	0	0
%  1002	1003	1005	 87.1019	0	0 	0	0
%  1005	1003	1001	 16.2741	0	0 	0	0
%freedy
%  1005	1003	1001	 16.2888	0	0 	0	0
%  1001	1003	1004	130.9716	0	0 	0	0
%  1004	1003	1002	165.5315	0	0 	0	0
%filip
%  1004	1003	1002	165.5351	0	0 	0	0
%  1002	1003	1005	 87.2420	0	0 	0	0
%  1005	1003	1001	 16.2687	0	0 	0	0
%  1001	1003	1004	130.9538	0	0 	0	0
%pavla
1002	1003	1001	103.4470	0	0 	0	0	0	0	0	0
1001	1003	1004	130.9516	0	0 	0	0	0	0	0	0
1002	1003	1004	234.3983	0	0 	0	0	0	0	0	0
1005	1003	1001     16.2638	0	0 	0	0	0	0	0	0

1002	1004	1001	 65.1649	0	0 	0	0	0	0	0	0
1003	1004	1001	 45.9957	0	0 	0	0	0	0	0	0
1002	1004	1003	 19.1715	0	0 	0	0	0	0	0	0

% smìrník urèený gyrákem 1005ex - 1003ex:
9999	1005	1003	282.8233	0	0 	0	0	0	0	0	0
% smìrník z mìøení na slunce 1002ex - 1004ex:
9999	1002	1004	210.8992	0	0 	0	0	0	0	0	0
% smìrník z mìøení na slunce 1001ex - 1003ex:
9999	1001	1003	298.9216	0	0 	0	0	0	0	0	0
% smìrník z mìøení na slunce 1001ex - 1002ex:
9999	1001	1002	335.5045	0	0 	0	0	0	0	0	0
% smìrník z mìøení na slunce 1003ex - 1004ex:
9999	1003	1004	230.0155	0	0 	0	0	0	0	0	0
% smìrník z mìøení na slunce 1004ex - 1003ex:
9999	1004	1003	 30.0374	0	0 	0	0	0	0	0	0
];

%==========================================================================================================
%|                                          Výpoèetní cyklus                                              |
%==========================================================================================================

%----------------------------------------------------------------------------------------------------------
%|                                       Úhly ze souøadnic GPS                                            |
%----------------------------------------------------------------------------------------------------------

for i = 1 : rows(uhly)
  if uhly(i,1) == 9999
    bod1 = souradnice_gps(find(souradnice_gps(:,1)==uhly(i,2)), :);
    bod2 = souradnice_gps(find(souradnice_gps(:,1)==uhly(i,3)), :);
    
    uhly(i,6) = smernik(bod1, bod2);
  else
    uhly(i,6) = uhel(souradnice_gps,uhly(i,1),uhly(i,2),uhly(i,3));
  end
end

%----------------------------------------------------------------------------------------------------------
%|                         Oprava laboratorních jednotek o centraèní zmìnu                                |
%----------------------------------------------------------------------------------------------------------

for i = 1 : rows(uhly)
  if uhly(i,1) == 9999
    uhly(i,5) = uhly(i,4) - centracni_zmena(uhly(i,2),uhly(i,3)) - oprava_krovak(souradnice_priblizne,uhly(i,2),uhly(i,3));
    uhly(i,7) = uhly(i,6)-uhly(i,4);
    uhly(i,8) = uhly(i,6)-uhly(i,5);
    uhly(i,9) = 0;
    uhly(i,10) = 0;
    uhly(i,11) = centracni_zmena(uhly(i,2),uhly(i,3));
    uhly(i,12) = oprava_krovak(souradnice_priblizne,uhly(i,2),uhly(i,3));

  else
    uhly(i,5) = uhly(i,4) + centracni_zmena(uhly(i,2),uhly(i,1)) + oprava_krovak(souradnice_priblizne,uhly(i,2),uhly(i,1)) - centracni_zmena(uhly(i,2),uhly(i,3)) - oprava_krovak(souradnice_priblizne,uhly(i,2),uhly(i,3));
    uhly(i,7) = uhly(i,6)-uhly(i,4);
    uhly(i,8) = uhly(i,6)-uhly(i,5);
    uhly(i,9) = centracni_zmena(uhly(i,2),uhly(i,1));
    uhly(i,10) = oprava_krovak(souradnice_priblizne,uhly(i,2),uhly(i,1));
    uhly(i,11) = centracni_zmena(uhly(i,2),uhly(i,3));
    uhly(i,12) = oprava_krovak(souradnice_priblizne,uhly(i,2),uhly(i,3));
  end
end

uhly

